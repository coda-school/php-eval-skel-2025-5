{% extends 'base.html.twig' %}

{% block title %}Hello FeedController!{% endblock %}

{% block body %}
    <div class="feed">
        <h1>Fil d’actualité</h1>

        {% if app.user %}
            <div class="tweet-form">
                {{ form_start(tweetForm) }}
                {{ form_widget(tweetForm) }}
                <button type="submit">Tweeter</button>
                {{ form_end(tweetForm) }}
            </div>
            <hr>
        {% endif %}


        {% if tweets is empty %}
            <p>Aucun tweet à afficher.</p>
        {% else %}
            {% for tweet in tweets %}
                <div class="tweet">
                    <p>
                        <strong>{{ tweet.author.username }}</strong>
                        <small>– {{ tweet.createdAt|date('d/m/Y H:i') }}</small>
                    </p>

                    <p>{{ tweet.content }}</p>

                    {# Bouton supprimer (uniquement si c’est ton tweet) #}
                    {% if app.user and tweet.author == app.user %}
                        <form method="post"
                              action="{{ path('tweet_delete', { id: tweet.id }) }}"
                              onsubmit="return confirm('Supprimer ce tweet ?');">
                            <button type="submit">Supprimer</button>
                        </form>
                    {% endif %}
                </div>
                <hr>
            {% endfor %}
        {% endif %}
    </div>
{% endblock %}

